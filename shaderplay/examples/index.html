<!doctype html>

<html lang="eng">
	<head>
		<title>rollersonly.com</title>
		<link type="text/css" rel="stylesheet" href="../examples/style.css">

		<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js" integrity="sha512-dLxUelApnYxpLt6K2iomGngnHO83iUvZytA3YjDUCjT0HDOHKXnVYdf3hU4JjM8uEhxf9nD1/ey98U3t2vZ0qQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
		<script src="https://cdn.rawgit.com/mrdoob/three.js/master/examples/js/loaders/GLTFLoader.js"></script> -->
		<!-- 		<script src="three/examples/jsm/loaders/GLTFLoader.js"></script>-->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script> 
	</head>
	<body>
		<!-- <script type="application/javascript" src="../build/three.module.js"></script> -->
		<!-- <script type="module" src="script.js"></script> -->
		<script type="module">
			
			import * as THREE from '../build/three.module.js';

			import { GLTFLoader } from '../examples/jsm/loaders/GLTFLoader.js';

			const scene = new THREE.Scene();
			const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
			camera.translateZ( 20 );
			camera.translateY( 10 );

			const renderer = new THREE.WebGLRenderer();
			renderer.setSize(window.innerWidth, window.innerHeight);
			document.body.appendChild(renderer.domElement);

			scene.background = new THREE.Color('grey');

			const BasicShader = {

				uniforms: {},

				vertexShader: /* glsl */ `
					varying vec3 fNormal;
					varying vec3 fPosition;
					varying float intensity;

					const vec3 light = vec3(1.0, 1.0, 1.0);
					const vec3 ambient = vec3(0.01, 0.01, 0.01);

					void main() {
						fNormal = normalize(normalMatrix * normal);
			  			vec4 pos = modelViewMatrix * vec4(position, 1.0);
			  			fPosition = pos.xyz;
			  
			  			vec3 view = normalize(projectionMatrix * vec4(0.0, 0.0, 0.0, 1.0) - vec4(fPosition, 1.0)).xyz;
			  			vec3 lightDir = normalize(light - fPosition);
			  			float diffuse = dot(lightDir, fNormal);
			  			intensity = diffuse + dot(diffuse * 2.0 * fNormal - lightDir, view);

			  			if (intensity < 0.0) {
			    			intensity = 0.0;
			  			}
			  
			  			gl_Position = projectionMatrix *pos;		
			  		}`,

				fragmentShader: /* glsl */ `
					varying float intensity;

					void main() {
			  			gl_FragColor = vec4(1.0, 0.69, 0.4, 1.0) * (intensity + 0.1);
					}`

			};

			// const gl = renderer.getContext();

			// const glVertexShader = renderer.WebGLShader( gl, gl.VERTEX_SHADER, BasicShader.vertexShader );
			// const glFragmentShader = renderer.WebGLShader( gl, gl.FRAGMENT_SHADER, BasicShader.fragmentShader );

			// const program = gl.createProgram();

			// gl.attachShader( program, glVertexShader );
			// gl.attachShader( program, glFragmentShader );

			// gl.linkProgram( program );

			let shaderMaterial = new THREE.ShaderMaterial({
				vertexShader: BasicShader.vertexShader,
				fragmentShader: BasicShader.fragmentShader
			});

			const loader = new GLTFLoader();
			let car;
			let root;

			loader.load('../examples/Hydrozoan-jelly.gltf', function(gltf) {
				console.log("initial worked");
				root = gltf.scene;
				//car = new THREE.Mesh(root, shaderMaterial);

				scene.add( root );
				animate();
			}, undefined, function(error) {
				console.log(error);
			});

			function animate() {
				requestAnimationFrame(animate);

				//cube.rotation.x += 0.01;
				//cube.rotation.y += 0.01;

				//root.rotation.x += 0.01;
				root.rotation.y += 0.01

				renderer.render(scene, camera);
			}
		</script>
	</body>
</html>